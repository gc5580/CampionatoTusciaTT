<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DEBUG Classifica Giocatori</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  pre { background: #f0f0f0; padding: 10px; border: 1px solid #ccc; white-space: pre-wrap; }
</style>
</head>
<body>

<h1>Classifica Giocatori (MODALITÀ DEBUG)</h1>
<div id="debugOutput">Caricamento in corso...</div>

<script>
const csvUrl = "Classifica.csv"; 

fetch(csvUrl)
  .then(response => {
    if (!response.ok) {
        throw new Error(`Errore HTTP: ${response.status}. Controlla la console Network (F12).`);
    }
    return response.text();
  })
  .then(data => {
    // 1. Mostra i dati grezzi letti
    document.getElementById("debugOutput").innerHTML = "<h2>Dati Grezzi (testo letto):</h2>";
    document.getElementById("debugOutput").innerHTML += `<pre>${data}</pre>`;
    
    // 2. Tenta il parsing con il punto e virgola
    try {
        const rows = data.split("\n").map(r => r.split(";")); 

        document.getElementById("debugOutput").innerHTML += "<h2>Risultato Parsing (Array JS):</h2>";
        document.getElementById("debugOutput").innerHTML += `<pre>${JSON.stringify(rows, null, 2)}</pre>`;
        
        // Controlla se l'array risultante è ragionevole (deve avere più di una riga o delle colonne)
        if (rows.length > 1 && rows[0].length > 1) {
            document.getElementById("debugOutput").innerHTML += "✅ Dati letti e analizzati correttamente! Il problema è nella logica della tabella.";
        } else {
             document.getElementById("debugOutput").innerHTML += "❌ ATTENZIONE: Il parsing ha prodotto un array troppo piccolo o vuoto. Potrebbe esserci un problema con l'encoding o con righe vuote iniziali.";
        }
        
    } catch(e) {
        document.getElementById("debugOutput").innerHTML += "<h2>Errore nel Parsing:</h2>";
        document.getElementById("debugOutput").innerHTML += `<pre>${e.message}</pre>`;
    }

  })
  .catch(err => {
    console.error("Errore FATALE di caricamento CSV:", err);
    document.getElementById("debugOutput").innerHTML = `<caption>Errore FATALE: ${err.message}. Controlla la Console (F12).</caption>`;
  });
</script>

</body>
</html>